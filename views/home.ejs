<%- include("partials/header", { username: username }) -%>
    <div class="welcome">

        <div class="">
            <a href="/<%= username %>/compose">
                <button class="btn plus py-1 px-4 shadow rounded-pill">Compose</button>
            </a>
        </div>
        <h1 class="text-black font-bold font-weight-600 quote">'<%= startText %>'
        </h1>

    </div>




    <div class="post-div">
        <% posts.forEach(element=> { %>

            <div class="post-card shadow border">
                <div class="d-flex gap-2 flex-row-reverse pb-2">

                    <button class="d-flex btn btn-danger rounded-pill"
                        onclick="deletePost('<%= element.title %>')">Delete</button>
                    <button class="btn btn-success rounded-pill"
                        onclick="editPost('<%= element.title %>')">Edit</button>
                </div>

                <h1>
                    <%= element.title %>
                </h1>
                <p>
                    <%= element.content.substring(0,100)+" ..." %> <br />
                        <a class="btn btn-secondary border mt-4" href="/<%= username %>/posts/<%= element.title %>">Read
                            more</a>
                </p>
            </div>
            <% }); %>
    </div>




    <%- include("partials/footer") -%>
        <script>
            async function deletePost(title) {
                if (confirm("Are you sure you want to delete this post?")) {
                    const response = await fetch(`/delete/${title}`, {
                        method: "DELETE"
                    });

                    if (response.ok) {

                        window.location.reload();
                    } else {
                        alert("Failed to delete the post.");
                    }
                }
            }

            function editPost(title) {
                window.location.href = `/edit/${encodeURIComponent(title)}`;
            }

        </script>